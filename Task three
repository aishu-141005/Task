import nltk
import random
import string



from nltk.tokenize import word_tokenize
from nltk.stem import WordNetLemmatizer

lemmatizer = WordNetLemmatizer()

def preprocess(sentence):
    tokens = word_tokenize(sentence.lower())
    tokens = [lemmatizer.lemmatize(word) for word in tokens if word not in string.punctuation]
    return tokens


intents = {
    "greeting": {
        "keywords": ["hello", "hi", "hey", "greetings"],
        "responses": ["Hello! How can I help you today?", "Hi there!", "Hey! What's up?"]
    },
    "goodbye": {
        "keywords": ["bye", "goodbye", "see you", "quit", "exit"],
        "responses": ["Goodbye! Have a nice day!", "See you soon!", "Take care!"]
    },
    "study": {
        "keywords": ["study", "college", "exam", "subject", "project"],
        "responses": ["Stay focused on your studies!", 
                      "Make a timetable to prepare for exams.", 
                      "Donâ€™t forget to take breaks while studying!"]
    },
    "default": {
        "responses": ["Sorry, I didnâ€™t understand that.", 
                      "Can you rephrase your question?", 
                      "Hmm, letâ€™s talk about studies, greetings, or college!"]
    }
}


def chatbot_response(user_input):
    tokens = preprocess(user_input)
    for intent, intent_data in intents.items():
        for word in tokens:
            if word in intent_data.get("keywords", []):
                return random.choice(intent_data["responses"])
    return random.choice(intents["default"]["responses"])


print("ðŸ¤– Chatbot is running! (type 'quit' to exit)\n")

while True:
    user_input = input("You: ")
    if user_input.lower() in ["quit", "exit", "bye"]:
        print("Bot:", random.choice(intents["goodbye"]["responses"]))
        break
    response = chatbot_response(user_input)
    print("Bot:", response)
